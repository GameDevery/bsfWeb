<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>bs::f docs - Smart pointers</title>
<link rel="icon" type="image/png" href="logo.png">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href='https://fonts.googleapis.com/css?family=Lato:normal,bold|Cabin:normal,bold' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="SemanticUI/semantic.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxystyle.css" rel="stylesheet" type="text/css"/>
<link href="SemanticUI/semantic.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="everything">
	<div class="ui inverted vertical center aligned segment" id="menuSegment">
		<div class="ui container">
			<div class="ui inverted mainmenu menu">
				<a href="https://www.bsframework.io"><div class="item" id="logoItem"><img class="ui image" id="logo" src="logoHeader.png"></div></a>
				<div class="right menu">
					<a class="borderless item" href="https://www.bsframework.io">Home</a>
					<a class="item" href="https://www.bsframework.io/download.html">Download</a>
					<a class="item" href="https://discourse.bsframework.io">Community</a>
					<a class="active item" href="https://www.bsframework.io/docs/index.html">Documentation</a>
					<a class="item" href="https://github.com/gamefoundry/bsf"><i class="github icon"></i>GitHub</a>
				</div>
			</div>
		</div>
	</div>	
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Smart pointers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#smartPointers_a">Unique pointers</a><ul><li class="level2"><a href="#smartPointers_a_a">Transfering ownership</a></li>
</ul>
</li>
<li class="level1"><a href="#smartPointers_b">Shared pointers</a></li>
</ul>
</div>
<div class="textblock"><p>Smart pointers allow the user to allocate objects dynamically, but without having to worry about freeing the object. They are prefered to normal memory allocation as they prevent memory leaks when the user might forget to free memory. They are particularily very useful in situations when object ownership is not clearly defined and it might not be clear who is responsible for freeing the object, or when.</p>
<h1><a class="anchor" id="smartPointers_a"></a>
Unique pointers</h1>
<p>Unique pointers hold ownership of a dynamically allocated object, and automatically free it when they go out of scope. As their name implies they cannot be copied - in other words, only one pointer to that object can exist. They are mostly useful for temporary allocations, or for places where object ownership is clearly defined to a single owner.</p>
<p>In bs::f type're represented with <a class="el" href="group___memory.html#ga2fcfc1ebb9680543572a71214449d00d">UPtr</a>, which is just a wrapper for the standard library's <em>std::unique_ptr</em>. Use <a class="el" href="group___memory.html#gaef07c929a2f670e4336d7c8afb89a175">bs_unique_ptr_new&lt;T&gt;</a> to create a unique pointer pointing to a new instance of T, or <a class="el" href="group___memory.html#ga0366f428651831d3585dae578cd99e4f">bs_unique_ptr</a> to create one from an existing instance.</p>
<div class="fragment"><div class="line"><span class="comment">// Helper structure</span></div><div class="line"><span class="keyword">struct </span>MyStruct </div><div class="line">{ </div><div class="line">    MyStruct() {}</div><div class="line">    MyStruct(<span class="keywordtype">int</span> a, <span class="keywordtype">bool</span> b)</div><div class="line">        :a(a), b(b)</div><div class="line">    { }</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> a; </div><div class="line">    <span class="keywordtype">bool</span> b; </div><div class="line">};</div><div class="line"></div><div class="line">UPtr&lt;MyStruct&gt; ptr = bs_unique_ptr_new&lt;MyStruct&gt;(123, <span class="keyword">false</span>);</div><div class="line"></div><div class="line"><span class="comment">// No need to free &quot;ptr&quot;, it will automatically be freed when it goes out of scope</span></div></div><!-- fragment --><h2><a class="anchor" id="smartPointers_a_a"></a>
Transfering ownership</h2>
<p>Since only a single instance of a unique pointer to a specific object may exist, they cannot be copied. However sometimes it is useful to move them to another object (transfer of ownership). In such case you can use <em>std::move</em> as shown below:</p>
<div class="fragment"><div class="line">UPtr&lt;MyStruct&gt; ptr = bs_unique_ptr_new&lt;MyStruct&gt;(123, <span class="keyword">false</span>);</div><div class="line"></div><div class="line"><span class="comment">// Transfer ownership</span></div><div class="line">UPtr&lt;MyStruct&gt; ptrOther = std::move(ptr);</div><div class="line"></div><div class="line"><span class="comment">// ptrOther now owns the object, while ptr is undefined</span></div></div><!-- fragment --><h1><a class="anchor" id="smartPointers_b"></a>
Shared pointers</h1>
<p>Shared pointers are similar to unique pointers, as they also don't require the object to be explicitly freed after creation. However, unlike unique pointers they can be copied (therefore their name "shared"). This means multiple entities can hold a shared pointer to a single object. Only once ALL such entities lose their shared pointers will the pointed-to object be destroyed.</p>
<p>In bs::f they are represented with <a class="el" href="group___memory.html#ga5076b1659821c8d7ce06da09452ba382">SPtr</a>, which is just a wrapper for the standard library's <em>std::shared_ptr</em>. Use <a class="el" href="group___memory.html#gac31f635d3674cace8ebb4bc24f02cd50">bs_shared_ptr_new&lt;T&gt;</a> to create a shared pointer pointing to a new instance of T, or <a class="el" href="group___memory.html#ga9ebb1521ba3a4100a39212ab127e659a">bs_shared_ptr</a> to create one from an existing instance.</p>
<p>You will find bs::f uses shared pointers commonly all around its codebase.</p>
<div class="fragment"><div class="line">SPtr&lt;MyStruct&gt; ptr = bs_shared_ptr_new&lt;MyStruct&gt;(123, <span class="keyword">false</span>);</div><div class="line">SPtr&lt;MyStruct&gt; anotherPtr = ptr;</div><div class="line"></div><div class="line"><span class="comment">// Object will be freed after both &quot;ptr&quot; and &quot;anotherPtr&quot; go out of scope. </span></div><div class="line"><span class="comment">// Normally you&#39;d want to pass a copy of the pointer to some other system, otherwise we could have used a unique ptr in this particular example</span></div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
    <!-- Footer -->
    <div class="myFooter">
		<div class="ui inverted vertical footer segment" style="border-top: 2px solid #f9500d;">
			<div class="ui container">
				<div class="ui stackable inverted divided equal height grid">
					<div class="three wide column">
						<h4 class="ui inverted header">Contact</h4>
						<div class="ui inverted link list">
							<a href="mailto:contact@bsframework.io" class="item">Contact us</a>
							<a href="https://github.com/GameFoundry/bsf/issues" target="_blank" class="item">Report an issue</a>
						</div>
					</div>
					<div class="three wide column">
						<h4 class="ui inverted header">Info</h4>
						<div class="ui inverted link list">
							<a href="https://github.com/GameFoundry/bsf" target="_blank" class="item">Contribute</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/Documentation/GitHub/roadmap.md" target="_blank" class="item">Roadmap</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/LICENSE.md" target="_blank" class="item">License</a>
						</div>
					</div>
					<div class="seven wide column">
						<h4 class="ui inverted header">Donate</h4>
						<div class="ui horizontal list">
							<div class="item"><a href="https://www.patreon.com/bsf"><img class="ui image" src="become_a_patron_button.png"></a></div>
							<div class="item"><a href="https://www.paypal.me/MarkoPintera/10" target="_blank"><img class="ui image" src="paypalDonate.png"></a></div>
						</div>
						<p style="padding-top:7px"><i>bs::f</i> is developed by Marko Pintera and contributors.</p>
					</div>
				</div>
			</div>
		</div>
	</div>
</div> <!-- Everything -->
</body>
</html>
