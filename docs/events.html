<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>bs::f docs - Events</title>
<link rel="icon" type="image/png" href="logo.png">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href='http://fonts.googleapis.com/css?family=Lato:normal,bold|Cabin:normal,bold' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="../SemanticUI/semantic.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxystyle.css" rel="stylesheet" type="text/css"/>
<link href="../SemanticUI/semantic.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="everything">
	<div class="ui inverted vertical center aligned segment" id="menuSegment">
		<div class="ui container">
			<div class="ui inverted mainmenu menu">
				<a href="https://www.bsframework.io"><div class="item" id="logoItem"><img class="ui image" id="logo" src="logoHeader.png"></div></a>
				<div class="right menu">
					<a class="borderless item" href="https://www.bsframework.io">Home</a>
					<a class="item" href="https://www.bsframework.io/download.html">Download</a>
					<a class="item" href="https://discourse.bsframework.io">Community</a>
					<a class="active item" href="https://www.bsframework.io/docs/index.html">Documentation</a>
					<a class="item" href="https://github.com/gamefoundry/bsf"><i class="github icon"></i>GitHub</a>
				</div>
			</div>
		</div>
	</div>	
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Events </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#events_a">Creating events</a></li>
<li class="level1"><a href="#events_b">Triggering events</a></li>
<li class="level1"><a href="#events_c">Subscribing to events</a><ul><li class="level2"><a href="#events_c_a">Class methods as event callbacks</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Events allow objects to expose events that may trigger during execution. External objects interested in those events can then register callbacks with those events and be notified when they happen. They are useful because they allow two objects to communicate without necessarily knowing about each other's types, which can reduce class coupling and improve design.</p>
<p>They're represented with the <a class="el" href="classbs_1_1_t_event.html">Event</a> class.</p>
<h1><a class="anchor" id="events_a"></a>
Creating events</h1>
<p>When creating an event, all you need to do is specify a format of the callback it sends out, for example: </p><div class="fragment"><div class="line"><span class="keyword">class </span>MyPlayerController</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Event&lt;void()&gt; onPlayerJumped; <span class="comment">// Event that triggers a callback with no parameters</span></div><div class="line">    Event&lt;void(UINT32)&gt; onPlayerCollectedCoins; <span class="comment">// Event that triggers a callback with an UINT32 parameter</span></div><div class="line">};</div></div><!-- fragment --><p>The format of the callback method signature is the same format as followed by C++ <em>std::function</em>: <em>returnType(param1Type, param2Type, ...)</em>.</p>
<h1><a class="anchor" id="events_b"></a>
Triggering events</h1>
<p>When an object is ready to trigger an event simply call it like a function: </p><div class="fragment"><div class="line"><span class="keyword">class </span>MyPlayerController</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="comment">// Assume this is a function called every frame</span></div><div class="line">    <span class="keywordtype">void</span> update()</div><div class="line">    {</div><div class="line">        <span class="keywordtype">bool</span> spacePressed = <span class="comment">/*... check input system for button press ...*/</span>;</div><div class="line">        UINT32 grabbedCoins = <span class="comment">/*... use physics system to see if player is colliding with any coin objects ...*/</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span>(spacePressed)</div><div class="line">            onPlayerJumped(); <span class="comment">// Trigger event</span></div><div class="line"></div><div class="line">        <span class="keywordflow">if</span>(grabbedCoins &gt; 0)</div><div class="line">            onPlayerCollectedCoins(grabbedCoins); <span class="comment">// Trigger event</span></div><div class="line">    }</div><div class="line"></div><div class="line">    Event&lt;void()&gt; onPlayerJumped;</div><div class="line">    Event&lt;void(UINT32)&gt; onPlayerCollectedCoins;</div><div class="line">};</div></div><!-- fragment --><h1><a class="anchor" id="events_c"></a>
Subscribing to events</h1>
<p>An external object can register itself with an event by calling <a class="el" href="classbs_1_1_t_event.html">Event::connect()</a>. </p><div class="fragment"><div class="line"><span class="comment">// Define a couple of methods that trigger when events are triggered</span></div><div class="line"><span class="keyword">auto</span> playerJumpedCallback = [&amp;]()</div><div class="line">{</div><div class="line">    <a class="code" href="group___debug.html#ga3d2df36e0b331304f012c778c43d86a9">gDebug</a>().<a class="code" href="classbs_1_1_debug.html#acb8d76b720a9ce83aff8bcef5340151b">logDebug</a>(<span class="stringliteral">&quot;Player jumped!&quot;</span>);</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">auto</span> playerCollectedCoinsCallback = [&amp;](UINT32 numCoins)</div><div class="line">{</div><div class="line">    <a class="code" href="group___debug.html#ga3d2df36e0b331304f012c778c43d86a9">gDebug</a>().<a class="code" href="classbs_1_1_debug.html#acb8d76b720a9ce83aff8bcef5340151b">logDebug</a>(<span class="stringliteral">&quot;Player collected: &quot;</span> + <a class="code" href="group___string.html#ga852e40fdd80b537b8ccf93e9cefe0e2b">toString</a>(numCoins) + <span class="stringliteral">&quot; coins!&quot;</span>);</div><div class="line">};</div><div class="line"></div><div class="line">MyPlayerController playerController;</div><div class="line"></div><div class="line"><span class="comment">// Subscribe to events</span></div><div class="line">playerController.onPlayerJumped.connect(&amp;playerJumpedCallback);</div><div class="line">playerController.onPlayerCollectedCoins.connect(&amp;playerCollectedCoinsCallback);</div><div class="line"></div><div class="line"><span class="comment">// ... run player logic every frame ...</span></div></div><!-- fragment --><p>Subscribing to an event will return an <a class="el" href="classbs_1_1_h_event.html">HEvent</a> handle. You can use this handle to manually disconnect from the event by calling <a class="el" href="classbs_1_1_h_event.html#a960705de531a20389fb29928d43258c3">HEvent::disconnect</a>. For example:</p>
<div class="fragment"><div class="line">HEvent eventHandle = playerController.onPlayerJumped.connect(&amp;playerJumpedCallback);</div><div class="line"></div><div class="line"><span class="comment">// ... do something and decide event is no longer required ...</span></div><div class="line"></div><div class="line">eventHandle.disconnect();</div></div><!-- fragment --><h2><a class="anchor" id="events_c_a"></a>
Class methods as event callbacks</h2>
<p>In the example above we used lambda functions as event callbacks, and it would have also worked for global functions, but if you wish to use class methods as event callbacks, some additional logic is required.</p>
<p>The main difference between lambda/global functions and class methods is that class methods have an implicit parameter, the <em>this</em> pointer. This is not something you see when you define a function, but it is always there "under the hood".</p>
<p>For example: </p><div class="fragment"><div class="line"><span class="keyword">class </span>MyEventSubscriber</div><div class="line">{</div><div class="line">    <span class="keywordtype">void</span> eventCallback(); <span class="comment">// What you see</span></div><div class="line">    <span class="comment">// void eventCallback(MyEventSubscriber* thisPtr); // What the compiler sees for the above method</span></div><div class="line">};</div></div><!-- fragment --><p>When setting up event callbacks we must therefore provide the <em>this</em> pointer manually. However since the event owner has no idea which class will subscribe to its event, it cannot provide the <em>this</em> pointer to the object of that class. By using <b>std::bind</b> the event subscriber can instead permanently bind its <em>this</em> pointer when subscribing to an event.</p>
<p>If you are unfamiliar with <em>std::bind</em>, it basically transforms a function signature by permanently <em>binding</em> one of its parameters. Here's a simple example: </p><div class="fragment"><div class="line"><span class="keyword">auto</span> myFunc = [&amp;](UINT32 param)</div><div class="line">{ };</div><div class="line"></div><div class="line"><span class="comment">// Permanently binds 5 as the function parameter</span></div><div class="line"><span class="keyword">auto</span> myFuncNoParams = std::bind(myFunc, 5);</div><div class="line"></div><div class="line"><span class="comment">// Call the function with parameter 5</span></div><div class="line">myFuncNoParams();</div></div><!-- fragment --><p>Using this same logic, we can permanently bind the <em>this</em> pointer when subscribing to an event: </p><div class="fragment"><div class="line"><span class="keyword">class </span>MyEventSubscriber</div><div class="line">{</div><div class="line">    <span class="keywordtype">void</span> playerJumpedCallback() <span class="comment">// Has a hidden &quot;this&quot; pointer parameter</span></div><div class="line">    {</div><div class="line">        <a class="code" href="group___debug.html#ga3d2df36e0b331304f012c778c43d86a9">gDebug</a>().<a class="code" href="classbs_1_1_debug.html#acb8d76b720a9ce83aff8bcef5340151b">logDebug</a>(<span class="stringliteral">&quot;Player jumped!&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Assuming the same player controller class we defined earlier</span></div><div class="line">    <span class="keywordtype">void</span> subscribeToEvents(MyPlayerController&amp; playerController)</div><div class="line">    {</div><div class="line">        <span class="comment">// Bind the &quot;this&quot; pointer</span></div><div class="line">        <span class="keyword">auto</span> callback = std::bind(&amp;MyEventSubscriber::playerJumpedCallback, <span class="keyword">this</span>);</div><div class="line"></div><div class="line">        <span class="comment">// Register the callback without the event needing to know about &quot;this&quot; pointer parameter</span></div><div class="line">        playerController.onPlayerJumped.connect(callback);</div><div class="line">    }</div><div class="line">};</div></div><!-- fragment --><p>Alternatively, you can wrap the class function call in a lambda function while capturing <em>this</em>. </p><div class="fragment"><div class="line"><span class="comment">// Alternative version of the above example, using lambda instead of std::bind</span></div><div class="line"><span class="keyword">class </span>MyEventSubscriber</div><div class="line">{</div><div class="line">    <span class="keywordtype">void</span> playerJumpedCallback() <span class="comment">// Has a hidden &quot;this&quot; pointer parameter</span></div><div class="line">    {</div><div class="line">        <a class="code" href="group___debug.html#ga3d2df36e0b331304f012c778c43d86a9">gDebug</a>().<a class="code" href="classbs_1_1_debug.html#acb8d76b720a9ce83aff8bcef5340151b">logDebug</a>(<span class="stringliteral">&quot;Player jumped!&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> subscribeToEvents(MyPlayerController&amp; playerController)</div><div class="line">    {</div><div class="line">        <span class="comment">// Wrap our class method call in a lambda function</span></div><div class="line">        <span class="keyword">auto</span> callback = [<span class="keyword">this</span>]()</div><div class="line">        {</div><div class="line">            playerJumpedCallback();</div><div class="line">        };</div><div class="line"></div><div class="line">        <span class="comment">// Register the callback without the event needing to know about &quot;this&quot; pointer parameter</span></div><div class="line">        playerController.onPlayerJumped.connect(callback);</div><div class="line">    }</div><div class="line">};</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
    <!-- Footer -->
    <div class="myFooter">
		<div class="ui inverted vertical footer segment" style="border-top: 2px solid #f9500d;">
			<div class="ui container">
				<div class="ui stackable inverted divided equal height grid">
					<div class="three wide column">
						<h4 class="ui inverted header">Contact</h4>
						<div class="ui inverted link list">
							<a href="mailto:contact@bsframework.io" class="item">Contact us</a>
							<a href="https://github.com/GameFoundry/bsf/issues" target="_blank" class="item">Report an issue</a>
						</div>
					</div>
					<div class="three wide column">
						<h4 class="ui inverted header">Info</h4>
						<div class="ui inverted link list">
							<a href="https://github.com/GameFoundry/bsf" target="_blank" class="item">Contribute</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/Documentation/GitHub/roadmap.md" target="_blank" class="item">Roadmap</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/LICENSE.md" target="_blank" class="item">License</a>
						</div>
					</div>
					<div class="seven wide column">
						<h4 class="ui inverted header">Donate</h4>
						<div class="ui horizontal list">
							<div class="item"><a href="https://www.patreon.com/bsf"><img class="ui image" src="become_a_patron_button.png"></a></div>
							<div class="item"><a href="https://www.paypal.me/MarkoPintera/10" target="_blank"><img class="ui image" src="paypalDonate.png"></a></div>
						</div>
						<p style="padding-top:7px"><i>bs::f</i> is developed by Marko Pintera and contributors.</p>
					</div>
				</div>
			</div>
		</div>
	</div>
</div> <!-- Everything -->
</body>
</html>
