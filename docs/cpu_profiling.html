<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>bs::f docs - Profiling</title>
<link rel="icon" type="image/png" href="logo.png">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href='https://fonts.googleapis.com/css?family=Lato:normal,bold|Cabin:normal,bold' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="SemanticUI/semantic.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxystyle.css" rel="stylesheet" type="text/css"/>
<link href="SemanticUI/semantic.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="everything">
	<div class="ui inverted vertical center aligned segment" id="menuSegment">
		<div class="ui container">
			<div class="ui inverted mainmenu menu">
				<a href="https://www.bsframework.io"><div class="item" id="logoItem"><img class="ui image" id="logo" src="logoHeader.png"></div></a>
				<div class="right menu">
					<a class="borderless item" href="https://www.bsframework.io">Home</a>
					<a class="item" href="https://www.bsframework.io/download.html">Download</a>
					<a class="item" href="https://discourse.bsframework.io">Community</a>
					<a class="active item" href="https://www.bsframework.io/docs/index.html">Documentation</a>
					<a class="item" href="https://github.com/gamefoundry/bsf"><i class="github icon"></i>GitHub</a>
				</div>
			</div>
		</div>
	</div>	
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Profiling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#cpuProfiling_a">Recording</a></li>
<li class="level1"><a href="#cpuProfiling_b">Reporting</a><ul><li class="level2"><a href="#cpuProfiling_b_a">Profiler overlay</a></li>
<li class="level2"><a href="#cpuProfiling_b_b">Threads</a></li>
<li class="level2"><a href="#cpuProfiling_b_c">Overhead</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Code profiling is an important process to determine performance bottlenecks. Profiling measures code execution times and memory allocations. bs::f provides a built-in profiler through the <a class="el" href="classbs_1_1_profiler_c_p_u.html">ProfilerCPU</a> module. This module can be globally accessed through <a class="el" href="group___profiling.html#ga879fa014c2bc67d539a324ead4a15c6d">gProfilerCPU()</a>.</p>
<p>The profiler allows you to profile blocks of code and output information about how long the block took to execute, as well as information about number and amount of memory allocations.</p>
<p>The profiler supports two separate measuring modes, the normal mode measures time in milliseconds, while the precise mode measures time in CPU cycles. The precise mode does have drawbacks as it is inacurrate for longer code as it will not account for OS context switches and similar. Usually you will be using the normal measuring mode, and reserve the precise mode when you need to know exactly how many cycles some relatively small operation takes.</p>
<h1><a class="anchor" id="cpuProfiling_a"></a>
Recording</h1>
<p>To start profiling a block call surround it with either:</p><ul>
<li><a class="el" href="classbs_1_1_profiler_c_p_u.html#abe880a1f30a029d26a46764b31f2d21e">ProfilerCPU::beginSample()</a> / <a class="el" href="classbs_1_1_profiler_c_p_u.html#ab6feeae3fb4e6f2824eefd22eff5d185">ProfilerCPU::endSample()</a> - Records timing information (in milliseconds) about the code in-between, as well as memory allocation information</li>
<li><a class="el" href="classbs_1_1_profiler_c_p_u.html#a2024968f5aad19b6fee27cbf84acb4e2">ProfilerCPU::beginSamplePrecise()</a> / <a class="el" href="classbs_1_1_profiler_c_p_u.html#ae80472e4cafb2a0fb819d022d3b02ddf">ProfilerCPU::endSamplePrecise()</a> - Records timing information (in CPU cyles) about the code in-between, as well as memory allocation information</li>
</ul>
<p>All of the methods above expect a name as a parameter, which is arbitrary and it is used so you can later identify the profiling information.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> doSomethingIntensive()</div><div class="line">{</div><div class="line">    <span class="comment">// ...</span></div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="group___profiling.html#ga879fa014c2bc67d539a324ead4a15c6d">gProfilerCPU</a>().<a class="code" href="classbs_1_1_profiler_c_p_u.html#abe880a1f30a029d26a46764b31f2d21e">beginSample</a>(<span class="stringliteral">&quot;myProfilingBlock&quot;</span>);</div><div class="line">doSomethingIntensive();</div><div class="line"><a class="code" href="group___profiling.html#ga879fa014c2bc67d539a324ead4a15c6d">gProfilerCPU</a>().<a class="code" href="classbs_1_1_profiler_c_p_u.html#ab6feeae3fb4e6f2824eefd22eff5d185">endSample</a>(<span class="stringliteral">&quot;myProfilingBlock&quot;</span>);</div></div><!-- fragment --><p>Each sample needs to have a <em>begin()</em> and an <em>end()</em> pair. Samples can be nested between other samples.</p>
<h1><a class="anchor" id="cpuProfiling_b"></a>
Reporting</h1>
<p>Once you have placed sample points around your code, you can retrieve the profiling report by calling <a class="el" href="classbs_1_1_profiler_c_p_u.html#ab4cc616333ed88810a64c5f0e3b480b8">ProfilerCPU::generateReport()</a>. This will return a <a class="el" href="classbs_1_1_c_p_u_profiler_report.html">CPUProfilerReport</a> object, which contains a list of normal and precise samples.</p>
<p>Each sampling entry is represented either by <a class="el" href="structbs_1_1_c_p_u_profiler_basic_sampling_entry.html">CPUProfilerBasicSamplingEntry</a> or <a class="el" href="structbs_1_1_c_p_u_profiler_precise_sampling_entry.html">CPUProfilerPreciseSamplingEntry</a>. Sampling entries contain information about the time it took to execute the code in the sampled block of code, as well as number of memory allocations &amp; deallocations, and total number of allocated and deallocated bytes. Each sample also contains a list of child samples (if any).</p>
<div class="fragment"><div class="line">CPUProfilerReport report = <a class="code" href="group___profiling.html#ga879fa014c2bc67d539a324ead4a15c6d">gProfilerCPU</a>().<a class="code" href="classbs_1_1_profiler_c_p_u.html#ab4cc616333ed88810a64c5f0e3b480b8">generateReport</a>();</div><div class="line"><span class="keywordflow">for</span>(CPUProfilerBasicSamplingEntry&amp; entry : report.getBasicSamplingData())</div><div class="line">{ <span class="comment">/* ... */</span> }</div><div class="line"></div><div class="line"><span class="keywordflow">for</span>(CPUProfilerPreciseSamplingEntry&amp; entry : report.getPreciseSamplingData())</div><div class="line">{ <span class="comment">/* ... */</span> }</div></div><!-- fragment --><p>After retrieving the data, you can log it, display it on screen, or similar.</p>
<h2><a class="anchor" id="cpuProfiling_b_a"></a>
Profiler overlay</h2>
<p>You can easily display the profiler reports on screen by adding the <a class="el" href="classbs_1_1_c_profiler_overlay.html">ProfilerOverlay</a> component to the scene and assigning it a camera. It will then automatically read profiler reports every frame and display them on the provided camera.</p>
<div class="fragment"><div class="line">HCamera camera = ...; <span class="comment">// Add a scene camera</span></div><div class="line"></div><div class="line">HSceneObject profilerOverlaySO = SceneObject::create(<span class="stringliteral">&quot;Profiler overlay&quot;</span>);</div><div class="line">HProfilerOverlay profilerOverlay = profilerOverlaySO-&gt;addComponent&lt;CProfilerOverlay&gt;(camera);</div></div><!-- fragment --><h2><a class="anchor" id="cpuProfiling_b_b"></a>
Threads</h2>
<p>The profiler is thread-safe, but if you are profiling code on threads not managed by the engine, you must manually call <a class="el" href="classbs_1_1_profiler_c_p_u.html#a6baf8a4391ab18ab1a660e68ada28854">ProfilerCPU::beginThread()</a> before any sample calls, and <a class="el" href="classbs_1_1_profiler_c_p_u.html#a0eb7f31ca839e1541209b3d3a5e882ed">ProfilerCPU::endThread()</a> after all sample calls.</p>
<h2><a class="anchor" id="cpuProfiling_b_c"></a>
Overhead</h2>
<p>Profiler code itself will introduce a certain amount of overhead which will slightly skew profiling results. The profiler attempts to estimate this error, which is reported in the returned reports. You can choose to take this into consideration if you need really precise results. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
    <!-- Footer -->
    <div class="myFooter">
		<div class="ui inverted vertical footer segment" style="border-top: 2px solid #f9500d;">
			<div class="ui container">
				<div class="ui stackable inverted divided equal height grid">
					<div class="three wide column">
						<h4 class="ui inverted header">Contact</h4>
						<div class="ui inverted link list">
							<a href="mailto:contact@bsframework.io" class="item">Contact us</a>
							<a href="https://github.com/GameFoundry/bsf/issues" target="_blank" class="item">Report an issue</a>
						</div>
					</div>
					<div class="three wide column">
						<h4 class="ui inverted header">Info</h4>
						<div class="ui inverted link list">
							<a href="https://github.com/GameFoundry/bsf" target="_blank" class="item">Contribute</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/Documentation/GitHub/roadmap.md" target="_blank" class="item">Roadmap</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/LICENSE.md" target="_blank" class="item">License</a>
						</div>
					</div>
					<div class="seven wide column">
						<h4 class="ui inverted header">Donate</h4>
						<div class="ui horizontal list">
							<div class="item"><a href="https://www.patreon.com/bsf"><img class="ui image" src="become_a_patron_button.png"></a></div>
							<div class="item"><a href="https://www.paypal.me/MarkoPintera/10" target="_blank"><img class="ui image" src="paypalDonate.png"></a></div>
						</div>
						<p style="padding-top:7px"><i>bs::f</i> is developed by Marko Pintera and contributors.</p>
					</div>
				</div>
			</div>
		</div>
	</div>
</div> <!-- Everything -->
</body>
</html>
