<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120676613-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-120676613-1');
</script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>bs::f docs - Saving a scene</title>
<link rel="icon" type="image/png" href="logo.png">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href='https://fonts.googleapis.com/css?family=Lato:normal,bold|Cabin:normal,bold' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="SemanticUI/semantic.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxystyle.css" rel="stylesheet" type="text/css"/>
<link href="SemanticUI/semantic.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="everything">
	<div class="ui inverted vertical center aligned segment" id="menuSegment">
		<div class="ui container">
			<div class="ui inverted mainmenu menu">
				<a href="https://www.bsframework.io"><div class="item" id="logoItem"><img class="ui image" id="logo" src="logoHeader.png"></div></a>
				<div class="right menu">
					<a class="borderless item" href="https://www.bsframework.io">Home</a>
					<a class="item" href="https://www.bsframework.io/download.html">Download</a>
					<a class="item" href="https://discourse.bsframework.io">Community</a>
					<a class="active item" href="https://www.bsframework.io/docs/index.html">Documentation</a>
					<a class="item" href="https://github.com/gamefoundry/bsf"><i class="github icon"></i>GitHub</a>
				</div>
			</div>
		</div>
	</div>	
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Saving a scene </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#savingScene_a">Creating prefabs</a></li>
<li class="level1"><a href="#savingScene_b">Saving &amp; loading prefabs</a></li>
<li class="level1"><a href="#savingScene_c">Instantiating prefabs</a></li>
<li class="level1"><a href="#savingScene_d">Resource manifest</a></li>
</ul>
</div>
<div class="textblock"><p>Once you have populated your scene with scene objects and components you will want to save it so you can easily load it later. The entire scene, as well as parts of the scene can be saved by creating a <a class="el" href="classbs_1_1_prefab.html">Prefab</a>.</p>
<h1><a class="anchor" id="savingScene_a"></a>
Creating prefabs</h1>
<p>A prefab can be created by calling <a class="el" href="classbs_1_1_prefab.html#ac9c9adc6b27e9a6a40803c4b3ec54c80">Prefab::create()</a> method and providing the relevant <b>SceneObject</b>. You can retrieve the root <b>SceneObject</b> of the current scene by calling <a class="el" href="classbs_1_1_scene_manager.html#a1d1ce23345b866509c4cf13853edc8a9">SceneManager::getRootNode()</a>, accessible through <a class="el" href="group___scene-_internal.html#ga4fe1577fc4b8df1cfeafb164bef158a7">gSceneManager()</a>. The second parameter of <b>Prefab::create()</b> controls whether the prefab represents an entire scene, or just a subset of scene objects.</p>
<div class="fragment"><div class="line"><span class="comment">// Get scene root</span></div><div class="line">HSceneObject sceneRoot = <a class="code" href="group___scene-_internal.html#ga4fe1577fc4b8df1cfeafb164bef158a7">gSceneManager</a>().<a class="code" href="classbs_1_1_scene_manager.html#a1d1ce23345b866509c4cf13853edc8a9">getRootNode</a>();</div><div class="line"></div><div class="line"><span class="comment">// Create a prefab of some sub-object</span></div><div class="line">HSceneObject subObject = sceneRoot-&gt;<a class="code" href="classbs_1_1_scene_object.html#ae38a5dff47d119a03a005d465bdaa6b2">findPath</a>(<span class="stringliteral">&quot;Path/To/Some/Object&quot;</span>);</div><div class="line">HPrefab partialPrefab = Prefab::create(subObject, <span class="keyword">false</span>);</div><div class="line"></div><div class="line"><span class="comment">// Create a prefab of the entire scene</span></div><div class="line">HPrefab scenePrefab = Prefab::create(sceneRoot, <span class="keyword">true</span>);</div></div><!-- fragment --><h1><a class="anchor" id="savingScene_b"></a>
Saving &amp; loading prefabs</h1>
<p>Once a prefab has been created it can be saved and loaded as any other <b>Resource</b>.</p>
<div class="fragment"><div class="line"><span class="comment">// Save the prefabs we created previously</span></div><div class="line"><a class="code" href="group___resources.html#ga9f2bdcc73874df6e64f4c1c72e56ab2a">gResources</a>().<a class="code" href="classbs_1_1_resources.html#a2f2f27ffa0c34bce3db574c9327bd0ac">save</a>(partialPrefab, <span class="stringliteral">&quot;partialPrefab.asset&quot;</span>);</div><div class="line"><a class="code" href="group___resources.html#ga9f2bdcc73874df6e64f4c1c72e56ab2a">gResources</a>().<a class="code" href="classbs_1_1_resources.html#a2f2f27ffa0c34bce3db574c9327bd0ac">save</a>(scenePrefab, <span class="stringliteral">&quot;scenePrefab.asset&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">// Then when ready, restore them</span></div><div class="line">HPrefab loadedPartialPrefab = <a class="code" href="group___resources.html#ga9f2bdcc73874df6e64f4c1c72e56ab2a">gResources</a>().<a class="code" href="classbs_1_1_resources.html#a267a91924db1c2fbaef8da0dd760655e">load</a>&lt;Prefab&gt;(<span class="stringliteral">&quot;partialPrefab.asset&quot;</span>);</div><div class="line">HPrefab loadedScenePrefab = <a class="code" href="group___resources.html#ga9f2bdcc73874df6e64f4c1c72e56ab2a">gResources</a>().<a class="code" href="classbs_1_1_resources.html#a267a91924db1c2fbaef8da0dd760655e">load</a>&lt;Prefab&gt;(<span class="stringliteral">&quot;scenePrefab.asset&quot;</span>);</div></div><!-- fragment --><h1><a class="anchor" id="savingScene_c"></a>
Instantiating prefabs</h1>
<p>After loading the prefab must be instantiated, creating a representation of the <b>SceneObject</b> hierarchy it contains. This is done by calling <a class="el" href="classbs_1_1_prefab.html#ab1b23591c49aac69b06918b0d70dcce7">Prefab::instantiate()</a> which returns a <b>SceneObject</b>. By default this scene object will be parented to the current scene root, but can then be manipulated as any other scene object. You can replace the current scene with a new <b>SceneObject</b> root by calling <a class="el" href="classbs_1_1_scene_manager.html#a3913e76f48dcb102f235e2c59ae55f06">SceneManager::setRootNode()</a>.</p>
<div class="fragment"><div class="line"><span class="comment">// Instatiate the scene prefab and replace the current scene</span></div><div class="line">HSceneObject newSceneHierarchy = loadedScenePrefab-&gt;instantiate();</div><div class="line"><a class="code" href="group___scene-_internal.html#ga4fe1577fc4b8df1cfeafb164bef158a7">gSceneManager</a>().<a class="code" href="classbs_1_1_scene_manager.html#a3913e76f48dcb102f235e2c59ae55f06">setRootNode</a>(newSceneHierarchy);</div></div><!-- fragment --><p>Since prefabs can also be created from arbitrary sub-hierarcies, you can use them to create groups of scene objects and components that are commonly used together, and then re-use them throughout the scene.</p>
<div class="fragment"><div class="line"><span class="comment">// Make a couple of copies of the prefab and place them in different parts of the scene</span></div><div class="line">HSceneObject subObject1 = loadedPartialPrefab-&gt;instantiate();</div><div class="line">HSceneObject subObject2 = loadedPartialPrefab-&gt;instantiate();</div><div class="line"></div><div class="line">subObject1-&gt;<a class="code" href="classbs_1_1_scene_object.html#af379928d936898c85a3717e4f2d49a4c">setPosition</a>(Vector3(10.0f, 0.0f, 0.0f));</div><div class="line">subObject1-&gt;setPosition(Vector3(50.0f, 0.0f, 0.0f));</div></div><!-- fragment --><h1><a class="anchor" id="savingScene_d"></a>
Resource manifest</h1>
<p>If your scene contains components that reference resources (e.g. a <b>Renderable</b> referencing a mesh or a material) you will also need to save a resource manifest along your scene. This is an important step as every scene will almost certainly reference some resources. The resource manifest allows the system to automatically find the referenced resources when loading the scene, even after application has been shutdown and started again. Without the manifest your scene will lose all references to any resources after attempting to load it in a new application session.</p>
<p>A manifest can be retrieved from <a class="el" href="classbs_1_1_resources.html#a35b1693250f22cbaa6a02186052c05cb">Resources::getResourceManifest()</a>. The method expect a manifest name, which will be "Default" for the default manifest. Resources will be registered in this manifest whenever you call <b>Resources::save()</b>.</p>
<blockquote class="doxtable">
<p>You can also create your own manifests and manage them manually but that is outside the scope of this topic. See the API reference for <a class="el" href="classbs_1_1_resource_manifest.html">ResourceManifest</a>. </p>
</blockquote>
<p>The manifest can then be saved by calling <a class="el" href="classbs_1_1_resource_manifest.html#a6dfc840835e791fddeb7fe8c008fcdc6">ResourceManifest::save()</a>. The method expects a file path in which to save the manifest in, as well as an optional path to which to make all the resources relative to. You will want to make the manifest relative to some folder so that you can relocate both the manifest and the resources and the system is still able to find them.</p>
<div class="fragment"><div class="line">SPtr&lt;ResourceManifest&gt; manifest = <a class="code" href="group___resources.html#ga9f2bdcc73874df6e64f4c1c72e56ab2a">gResources</a>().<a class="code" href="classbs_1_1_resources.html#a35b1693250f22cbaa6a02186052c05cb">getResourceManifest</a>(<span class="stringliteral">&quot;Default&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">// Save the manifest as &quot;myManifest.asset&quot;, with the assumption that all the resources</span></div><div class="line"><span class="comment">// it references have been saved to the &quot;C:/Data&quot; folder</span></div><div class="line">ResourceManifest::save(manifest, <span class="stringliteral">&quot;C:/myManifest.asset&quot;</span>, <span class="stringliteral">&quot;C:/Data&quot;</span>);</div></div><!-- fragment --><blockquote class="doxtable">
<p><b>SPtr</b> is a shared pointer, used in bs::f for most object instances that aren't components, scene objects or resources. It is covered later in the <a class="el" href="smart_pointers.html">smart pointers manual</a>. </p>
</blockquote>
<p>Before loading a <b>Prefab</b> you will need to restore the manifest by calling <a class="el" href="classbs_1_1_resource_manifest.html#aa41811a708d46096ad4ea8e89d54dd4a">ResourceManifest::load()</a>. Note that you only need to restore the manifest once when your application starts up (usually before any other resource loads).</p>
<p>Loaded manifest should then be registered with <b>Resources</b> by calling <a class="el" href="classbs_1_1_resources.html#a385826b002edc3497b9170711cf253e9">Resources::registerResourceManifest()</a>.</p>
<div class="fragment"><div class="line"><span class="comment">// Load the manifest. Assume that the application has moved to &quot;C:/Program Files (x86)/MyApp&quot;.</span></div><div class="line">SPtr&lt;ResourceManifest&gt; manifest = ResourceManifest::load(<span class="stringliteral">&quot;C:/Program Files (x86)/MyApp/myManifest.asset&quot;</span>, <span class="stringliteral">&quot;C:/Program Files (x86)/MyApp/Data&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">// Register the manifest</span></div><div class="line"><a class="code" href="group___resources.html#ga9f2bdcc73874df6e64f4c1c72e56ab2a">gResources</a>().<a class="code" href="classbs_1_1_resources.html#a385826b002edc3497b9170711cf253e9">registerResourceManifest</a>(manifest);</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
    <!-- Footer -->
    <div class="myFooter">
		<div class="ui inverted vertical footer segment" style="border-top: 2px solid #f9500d;">
			<div class="ui container">
				<div class="ui stackable inverted divided equal height grid">
					<div class="three wide column">
						<h4 class="ui inverted header">Contact</h4>
						<div class="ui inverted link list">
							<a href="mailto:contact@bsframework.io" class="item">Contact us</a>
							<a href="https://github.com/GameFoundry/bsf/issues" target="_blank" class="item">Report an issue</a>
						</div>
					</div>
					<div class="three wide column">
						<h4 class="ui inverted header">Info</h4>
						<div class="ui inverted link list">
							<a href="https://github.com/GameFoundry/bsf" target="_blank" class="item">Contribute</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/Documentation/GitHub/roadmap.md" target="_blank" class="item">Roadmap</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/LICENSE.md" target="_blank" class="item">License</a>
						</div>
					</div>
					<div class="seven wide column">
						<h4 class="ui inverted header">Donate</h4>
						<div class="ui horizontal list">
							<div class="item"><a href="https://www.patreon.com/bsf"><img class="ui image" src="become_a_patron_button.png"></a></div>
							<div class="item"><a href="https://www.paypal.me/MarkoPintera/10" target="_blank"><img class="ui image" src="paypalDonate.png"></a></div>
						</div>
						<p style="padding-top:7px"><i>bs::f</i> is developed by Marko Pintera and contributors.</p>
					</div>
				</div>
			</div>
		</div>
	</div>
</div> <!-- Everything -->
</body>
</html>
