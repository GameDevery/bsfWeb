<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120676613-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-120676613-1');
</script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>bs::f docs - Drawing</title>
<link rel="icon" type="image/png" href="logo.png">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href='https://fonts.googleapis.com/css?family=Lato:normal,bold|Cabin:normal,bold' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="SemanticUI/semantic.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxystyle.css" rel="stylesheet" type="text/css"/>
<link href="SemanticUI/semantic.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="everything">
	<div class="ui inverted vertical center aligned segment" id="menuSegment">
		<div class="ui container">
			<div class="ui inverted mainmenu menu">
				<a href="https://www.bsframework.io"><div class="item" id="logoItem"><img class="ui image" id="logo" src="logoHeader.png"></div></a>
				<div class="right menu">
					<a class="borderless item" href="https://www.bsframework.io">Home</a>
					<a class="item" href="https://www.bsframework.io/download.html">Download</a>
					<a class="item" href="https://discourse.bsframework.io">Community</a>
					<a class="active item" href="https://www.bsframework.io/docs/index.html">Documentation</a>
					<a class="item" href="https://github.com/gamefoundry/bsf"><i class="github icon"></i>GitHub</a>
				</div>
			</div>
		</div>
	</div>	
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Drawing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#drawing_a">Indexed drawing</a></li>
<li class="level1"><a href="#drawing_b">Non-indexed drawing</a></li>
<li class="level1"><a href="#drawing_c">Instanced drawing</a></li>
<li class="level1"><a href="#drawing_d">Drawing helper</a></li>
</ul>
</div>
<div class="textblock"><p>With all the objects from the previous chapters bound to the pipeline we are almost ready to draw an object. When drawing you must ensure a pipeline state of <b>GraphicsPipelineState</b> type is bound, instead of <b>ComputePipelineState</b>.</p>
<p>Next you need to specify what type of primitives you wish to draw by calling <a class="el" href="classbs_1_1ct_1_1_render_a_p_i.html#a70180438d34bfce5c147221ff1448ddf">ct::RenderAPI::setDrawOperation()</a>, which accepts any of the types defined in <a class="el" href="group___utility-_core.html#ga0a43fbead35d1ad167d465731c5c4c53">DrawOperationType</a>. This determines how are contents of the index buffer interpreted (or vertex buffer if index isn't available). The available draw types are:</p><ul>
<li><a class="el" href="group___utility-_core.html#gga0a43fbead35d1ad167d465731c5c4c53a530ec354e32a6c0f1382cd5c5fd5f085">DOT_POINT_LIST</a> - Each vertex represents a point.</li>
<li><a class="el" href="group___utility-_core.html#gga0a43fbead35d1ad167d465731c5c4c53a59e380488ff0c442fd61b520eb0f8591">DOT_LINE_LIST</a> - Each sequential pair of vertices represent a line.</li>
<li><a class="el" href="group___utility-_core.html#gga0a43fbead35d1ad167d465731c5c4c53aa87a8b21cabfd2106e49841a44bdeed5">DOT_LINE_STRIP</a> - Each vertex (except the first) forms a line with the previous vertex.</li>
<li><a class="el" href="group___utility-_core.html#gga0a43fbead35d1ad167d465731c5c4c53a834c797dc5a3784f668c00793e043234">DOT_TRIANGLE_LIST</a> - Each sequential 3-tuple of vertices represent a triangle.</li>
<li><a class="el" href="group___utility-_core.html#gga0a43fbead35d1ad167d465731c5c4c53a294354263ef34f436e89e26de0a86a7a">DOT_TRIANGLE_STRIP</a> - Each vertex (except the first two) form a triangle with the previous two vertices.</li>
<li><a class="el" href="group___utility-_core.html#gga0a43fbead35d1ad167d465731c5c4c53afe676f67173d2b3262bb01203dbdee36">DOT_TRIANGLE_FAN</a> - Each vertex (except the first two) forms a triangle with the first vertex and previous vertex.</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// We&#39;re drawing a triangle list</span></div><div class="line">RenderAPI&amp; rapi = RenderAPI::instance();</div><div class="line">rapi.setDrawOperation(<a class="code" href="group___utility-_core.html#gga0a43fbead35d1ad167d465731c5c4c53a834c797dc5a3784f668c00793e043234">DOT_TRIANGLE_LIST</a>);</div></div><!-- fragment --><h1><a class="anchor" id="drawing_a"></a>
Indexed drawing</h1>
<p>Finally you can now draw the object by calling <a class="el" href="classbs_1_1ct_1_1_render_a_p_i.html#ae7f5b32d5f5e2f8016b5c9d5078d28e4">ct::RenderAPI::drawIndexed()</a>. It requires the following parameters:</p><ul>
<li><code>startIndex</code> - Offset into the bound index buffer to start drawing from. In most cases this will be zero.</li>
<li><code>indexCount</code> - Number of indices to draw. Specify total number of indices in the index buffer to draw them all (most common case).</li>
<li><code>vertexOffset</code> - Offset to append to each index in the index buffer. Allows you to draw different set of vertices using the same index buffer. In most cases this will be zero.</li>
<li><code>vertexCount</code> - Number of vertices to draw. Since the actual number of primitives drawn is determined by the index count, this value is internally used just for tracking purposes and wont affect your rendering. In most cases you can specify the number of vertices in the vertex buffer(s).</li>
</ul>
<div class="fragment"><div class="line">SPtr&lt;IndexBuffer&gt; ib = ...;</div><div class="line">SPtr&lt;VertexBuffer&gt; vb = ...;</div><div class="line"></div><div class="line">UINT32 numIndices = ib-&gt;getProperties()-&gt;getNumIndices();</div><div class="line">UINT32 numVertices = vb-&gt;getProperties()-&gt;getNumVertices();</div><div class="line"></div><div class="line">RenderAPI&amp; rapi = RenderAPI::instance();</div><div class="line">rapi.drawIndexed(0, numIndices, 0, numVertices);</div></div><!-- fragment --><h1><a class="anchor" id="drawing_b"></a>
Non-indexed drawing</h1>
<p>If drawing without an index buffer you can call <a class="el" href="classbs_1_1ct_1_1_render_a_p_i.html#a1cc00f62de16b8141290d68cfe7b67a4">ct::RenderAPI::draw()</a> instead. It requires only the <code>vertexOffset</code> and <code>vertexCount</code> parameters, with same meaning as above (except <code>vertexCount</code> in this case does affect the rendering).</p>
<div class="fragment"><div class="line">SPtr&lt;VertexBuffer&gt; vb = ...;</div><div class="line">UINT32 numVertices = vb-&gt;getProperties()-&gt;getNumVertices();</div><div class="line"></div><div class="line">RenderAPI&amp; rapi = RenderAPI::instance();</div><div class="line">rapi.draw(0, numVertices);</div></div><!-- fragment --><h1><a class="anchor" id="drawing_c"></a>
Instanced drawing</h1>
<p>Both <b>ct::RenderAPI::draw()</b> and <b>ct::RenderAPI::drawIndexed()</b> support drawing multiple instances of the same object using the <code>instanceCount</code> parameter. This can be used as an alternative for issuing multiple <b>draw</b> calls, as they may have a significant CPU overhead. Using instanced drawing you can draw the same geometry multiple times with almost no additional CPU overhead.</p>
<div class="fragment"><div class="line"><span class="comment">// Draw 5 instances of the currently bound geometry</span></div><div class="line">rapi.drawIndexed(0, numIndices, 0, numVertices, 5);</div></div><!-- fragment --><p>In order for instanced drawing to actually be useful, in most cases we need a way to differentiate the instances. At the very least we usually want to draw the instances at different positions in the world.</p>
<p>This is done by creating a separate <b>VertexBuffer</b> that contains per-instance properties (like position). This buffer is created same as a normal vertex buffer, except it doesn't contain per-vertex data, and instead contains per-instance data.</p>
<p>In order to use such a buffer we need to let the pipeline know by creating an appropriate <b>VertexDeclaration</b>. We need to define a <b>VertexDataDesc</b> that contains per-instance data. This is done by specifying the <code>instanceStepRate</code> parameter when calling <b>VertexDataDesc::addVertElem()</b>.</p>
<div class="fragment"><div class="line">SPtr&lt;VertexDataDesc&gt; vertexDesc = VertexDataDesc::create();</div><div class="line"></div><div class="line"><span class="comment">// Per vertex data (same as for non-instanced drawing)</span></div><div class="line">vertexDesc-&gt;addVertElem(<a class="code" href="group___render_a_p_i.html#ggaff1f9fa06412cc13e0917617b7e8d0b3ae4a5d54927b375d5a3225252b46b7666">VET_FLOAT3</a>, <a class="code" href="group___render_a_p_i.html#ggaefea8c317b80104ca23292be815de16ca0544fdfda9308d37ae798590df511a18">VES_POSITION</a>);</div><div class="line">vertexDesc-&gt;addVertElem(<a class="code" href="group___render_a_p_i.html#ggaff1f9fa06412cc13e0917617b7e8d0b3ae4a5d54927b375d5a3225252b46b7666">VET_FLOAT3</a>, <a class="code" href="group___render_a_p_i.html#ggaefea8c317b80104ca23292be815de16ca8d273162b7f0c19183569f06985f72b9">VES_NORMAL</a>);</div><div class="line">vertexDesc-&gt;addVertElem(<a class="code" href="group___render_a_p_i.html#ggaff1f9fa06412cc13e0917617b7e8d0b3a8b7f33799c43b79dc274e1bdc0b98a4a">VET_FLOAT2</a>, <a class="code" href="group___render_a_p_i.html#ggaefea8c317b80104ca23292be815de16cacfca9b06a791a26a6b4031d191a690a5">VES_TEXCOORD</a>);</div><div class="line"></div><div class="line"><span class="comment">// Per instance data</span></div><div class="line">vertexDesc-&gt;addVertElem(</div><div class="line"> <a class="code" href="group___render_a_p_i.html#ggaff1f9fa06412cc13e0917617b7e8d0b3ae4a5d54927b375d5a3225252b46b7666">VET_FLOAT3</a>, <span class="comment">// Each entry in the instance vertex buffer is a 3D float</span></div><div class="line"> <a class="code" href="group___render_a_p_i.html#ggaefea8c317b80104ca23292be815de16ca0544fdfda9308d37ae798590df511a18">VES_POSITION</a>, <span class="comment">// We map it to the position semantic as vertex shader input</span></div><div class="line"> 1, <span class="comment">// We use the semantic index 1, as 0th index is taken by per-vertex VES_POSITION semantic</span></div><div class="line"> 1, <span class="comment">// We use the second bound vertex buffer for instance data</span></div><div class="line"> 1  <span class="comment">// Instance step rate of 1 means the new element will be fetched from the vertex buffer for each drawn instance</span></div><div class="line"> );</div><div class="line"></div><div class="line"><span class="comment">// Create a vertex declaration</span></div><div class="line">SPtr&lt;VertexDeclaration&gt; vertexDecl = VertexDeclaration::create(vertexDesc);</div><div class="line"></div><div class="line">RenderAPI&amp; rapi = RenderAPI::instance();</div><div class="line"></div><div class="line"><span class="comment">// Bind vertex declaration</span></div><div class="line">rapi.setVertexDeclaration(vertexDecl);</div><div class="line"></div><div class="line"><span class="comment">// Bind per-vertex and per-instance vertex buffers</span></div><div class="line">rapi.setVertexBuffers(0, { perVertexVB, perInstanceVB });</div><div class="line"></div><div class="line"><span class="comment">// Draw ...</span></div></div><!-- fragment --><h1><a class="anchor" id="drawing_d"></a>
Drawing helper</h1>
<p>As a way of making drawing easier you can also use <a class="el" href="classbs_1_1ct_1_1_renderer_utility.html#a61f31136006238fc059438e92379d97b">ct::RendererUtility::draw()</a> helper method, accessible globally through <a class="el" href="group___renderer-_engine-_internal.html#ga6580515aa43b883c40d15f1207618784">ct::gRendererUtility()</a>. This method accepts a <b>ct::Mesh</b> as input and will automatically:</p><ul>
<li>Bind vertex &amp; index buffer</li>
<li>Bind vertex declaration</li>
<li>Set draw operation type</li>
<li>Execute a draw call</li>
</ul>
<div class="fragment"><div class="line">SPtr&lt;Mesh&gt; mesh = ...;</div><div class="line"><a class="code" href="group___renderer-_engine-_internal.html#ga6580515aa43b883c40d15f1207618784">gRendererUtility</a>().<a class="code" href="classbs_1_1ct_1_1_renderer_utility.html#a61f31136006238fc059438e92379d97b">draw</a>(mesh);</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
    <!-- Footer -->
    <div class="myFooter">
		<div class="ui inverted vertical footer segment" style="border-top: 2px solid #f9500d;">
			<div class="ui container">
				<div class="ui stackable inverted divided equal height grid">
					<div class="three wide column">
						<h4 class="ui inverted header">Contact</h4>
						<div class="ui inverted link list">
							<a href="mailto:contact@bsframework.io" class="item">Contact us</a>
							<a href="https://github.com/GameFoundry/bsf/issues" target="_blank" class="item">Report an issue</a>
						</div>
					</div>
					<div class="three wide column">
						<h4 class="ui inverted header">Info</h4>
						<div class="ui inverted link list">
							<a href="https://github.com/GameFoundry/bsf" target="_blank" class="item">Contribute</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/Documentation/GitHub/roadmap.md" target="_blank" class="item">Roadmap</a>
							<a href="https://github.com/GameFoundry/bsf/blob/master/LICENSE.md" target="_blank" class="item">License</a>
						</div>
					</div>
					<div class="seven wide column">
						<h4 class="ui inverted header">Donate</h4>
						<div class="ui horizontal list">
							<div class="item"><a href="https://www.patreon.com/bsf"><img class="ui image" src="become_a_patron_button.png"></a></div>
							<div class="item"><a href="https://www.paypal.me/MarkoPintera/10" target="_blank"><img class="ui image" src="paypalDonate.png"></a></div>
						</div>
						<p style="padding-top:7px"><i>bs::f</i> is developed by Marko Pintera and contributors.</p>
					</div>
				</div>
			</div>
		</div>
	</div>
</div> <!-- Everything -->
</body>
</html>
